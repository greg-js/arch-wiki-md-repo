**Состояние перевода:** На этой странице представлен перевод статьи [CUPS/Troubleshooting](/index.php/CUPS/Troubleshooting "CUPS/Troubleshooting"). Дата последней синхронизации: 30 сентября 2018\. Вы можете [помочь](/index.php/ArchWiki_Translation_Team_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "ArchWiki Translation Team (Русский)") синхронизировать перевод, если в английской версии произошли [изменения](https://wiki.archlinux.org/index.php?title=CUPS/Troubleshooting&diff=0&oldid=545156).

Ссылки по теме

*   [CUPS (Русский)](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "CUPS (Русский)")
*   [CUPS/Принтероспецифичные проблемы](/index.php/CUPS/%D0%9F%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B "CUPS/Принтероспецифичные проблемы")

В этой статье рассматриваются все неспецифические (то есть не связанные с каким-либо одним принтером) проблемы CUPS и драйверов принтеров (но не проблемы, связанные с совместным использованием принтеров), включая методы определения точной природы проблемы и решения выявленной проблемы.

## Contents

*   [1 Введение](#.D0.92.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5)
*   [2 Проблемы, возникающие в результате обновлений](#.D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B.2C_.D0.B2.D0.BE.D0.B7.D0.BD.D0.B8.D0.BA.D0.B0.D1.8E.D1.89.D0.B8.D0.B5_.D0.B2_.D1.80.D0.B5.D0.B7.D1.83.D0.BB.D1.8C.D1.82.D0.B0.D1.82.D0.B5_.D0.BE.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B9)
    *   [2.1 CUPS останавливается](#CUPS_.D0.BE.D1.81.D1.82.D0.B0.D0.BD.D0.B0.D0.B2.D0.BB.D0.B8.D0.B2.D0.B0.D0.B5.D1.82.D1.81.D1.8F)
    *   [2.2 Для всех заданий - "остановлено"](#.D0.94.D0.BB.D1.8F_.D0.B2.D1.81.D0.B5.D1.85_.D0.B7.D0.B0.D0.B4.D0.B0.D0.BD.D0.B8.D0.B9_-_.22.D0.BE.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.BE.22)
    *   [2.3 Для всех заданий - "Принтер не отвечает"](#.D0.94.D0.BB.D1.8F_.D0.B2.D1.81.D0.B5.D1.85_.D0.B7.D0.B0.D0.B4.D0.B0.D0.BD.D0.B8.D0.B9_-_.22.D0.9F.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D0.BD.D0.B5_.D0.BE.D1.82.D0.B2.D0.B5.D1.87.D0.B0.D0.B5.D1.82.22)
    *   [2.4 Версия PPD не совместима с gutenprint](#.D0.92.D0.B5.D1.80.D1.81.D0.B8.D1.8F_PPD_.D0.BD.D0.B5_.D1.81.D0.BE.D0.B2.D0.BC.D0.B5.D1.81.D1.82.D0.B8.D0.BC.D0.B0_.D1.81_gutenprint)
*   [3 Проблемы с сетью](#.D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_.D1.81.D0.B5.D1.82.D1.8C.D1.8E)
    *   [3.1 Не удается найти принтер](#.D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.BD.D0.B0.D0.B9.D1.82.D0.B8_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80)
    *   [3.2 Старый сервер CUPS](#.D0.A1.D1.82.D0.B0.D1.80.D1.8B.D0.B9_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80_CUPS)
    *   [3.3 Общий принтер работает локально, но удаленный компьютер не печатает](#.D0.9E.D0.B1.D1.89.D0.B8.D0.B9_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_.D0.BB.D0.BE.D0.BA.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.2C_.D0.BD.D0.BE_.D1.83.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BA.D0.BE.D0.BC.D0.BF.D1.8C.D1.8E.D1.82.D0.B5.D1.80_.D0.BD.D0.B5_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B0.D0.B5.D1.82)
*   [4 USB-принтеры](#USB-.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.8B)
    *   [4.1 Конфликт с SANE](#.D0.9A.D0.BE.D0.BD.D1.84.D0.BB.D0.B8.D0.BA.D1.82_.D1.81_SANE)
    *   [4.2 Конфликт с usblp](#.D0.9A.D0.BE.D0.BD.D1.84.D0.BB.D0.B8.D0.BA.D1.82_.D1.81_usblp)
    *   [4.3 USB autosuspend](#USB_autosuspend)
    *   [4.4 Плохие разрешения](#.D0.9F.D0.BB.D0.BE.D1.85.D0.B8.D0.B5_.D1.80.D0.B0.D0.B7.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D1.8F)
*   [5 Проблемы с HP](#.D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_HP)
    *   [5.1 CUPS: "/usr/lib/cups/backend/hp failed"](#CUPS:_.22.2Fusr.2Flib.2Fcups.2Fbackend.2Fhp_failed.22)
    *   [5.2 CUPS: "Печать завершена", но принтер не печатает.](#CUPS:_.22.D0.9F.D0.B5.D1.87.D0.B0.D1.82.D1.8C_.D0.B7.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.D0.B0.22.2C_.D0.BD.D0.BE_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D0.BD.D0.B5_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B0.D0.B5.D1.82.)
    *   [5.3 CUPS: '"foomatic-rip" not available/stopped with status 3'](#CUPS:_.27.22foomatic-rip.22_not_available.2Fstopped_with_status_3.27)
    *   [5.4 CUPS: "Filter failed"](#CUPS:_.22Filter_failed.22)
        *   [5.4.1 Отсутствует ghostscript](#.D0.9E.D1.82.D1.81.D1.83.D1.82.D1.81.D1.82.D0.B2.D1.83.D0.B5.D1.82_ghostscript)
        *   [5.4.2 Отсутствует foomatic-db](#.D0.9E.D1.82.D1.81.D1.83.D1.82.D1.81.D1.82.D0.B2.D1.83.D0.B5.D1.82_foomatic-db)
        *   [5.4.3 Avahi не включен](#Avahi_.D0.BD.D0.B5_.D0.B2.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD)
        *   [5.4.4 Устаревший плагин](#.D0.A3.D1.81.D1.82.D0.B0.D1.80.D0.B5.D0.B2.D1.88.D0.B8.D0.B9_.D0.BF.D0.BB.D0.B0.D0.B3.D0.B8.D0.BD)
        *   [5.4.5 Устаревшая конфигурация принтера](#.D0.A3.D1.81.D1.82.D0.B0.D1.80.D0.B5.D0.B2.D1.88.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0)
    *   [5.5 CUPS: печатает только пустую страницу и страницу с сообщением об ошибке на HP LaserJet](#CUPS:_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B0.D0.B5.D1.82_.D1.82.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BF.D1.83.D1.81.D1.82.D1.83.D1.8E_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D1.83_.D0.B8_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D1.83_.D1.81_.D1.81.D0.BE.D0.BE.D0.B1.D1.89.D0.B5.D0.BD.D0.B8.D0.B5.D0.BC_.D0.BE.D0.B1_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B5_.D0.BD.D0.B0_HP_LaserJet)
    *   [5.6 HPLIP 3.13: Плагин установлен, но HP Device Manager жалуется на его отсутствие](#HPLIP_3.13:_.D0.9F.D0.BB.D0.B0.D0.B3.D0.B8.D0.BD_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.2C_.D0.BD.D0.BE_HP_Device_Manager_.D0.B6.D0.B0.D0.BB.D1.83.D0.B5.D1.82.D1.81.D1.8F_.D0.BD.D0.B0_.D0.B5.D0.B3.D0.BE_.D0.BE.D1.82.D1.81.D1.83.D1.82.D1.81.D1.82.D0.B2.D0.B8.D0.B5)
    *   [5.7 hp-toolbox: "Unable to communicate with device"](#hp-toolbox:_.22Unable_to_communicate_with_device.22)
        *   [5.7.1 Разрешение проблемы](#.D0.A0.D0.B0.D0.B7.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B)
        *   [5.7.2 Виртуальный CDROM у принтеров](#.D0.92.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_CDROM_.D1.83_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.BE.D0.B2)
        *   [5.7.3 Сетевые принтеры](#.D0.A1.D0.B5.D1.82.D0.B5.D0.B2.D1.8B.D0.B5_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.8B)
    *   [5.8 hp-setup просит указать PPD-файл для обнаруженного принтера](#hp-setup_.D0.BF.D1.80.D0.BE.D1.81.D0.B8.D1.82_.D1.83.D0.BA.D0.B0.D0.B7.D0.B0.D1.82.D1.8C_PPD-.D1.84.D0.B0.D0.B9.D0.BB_.D0.B4.D0.BB.D1.8F_.D0.BE.D0.B1.D0.BD.D0.B0.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0)
    *   [5.9 hp-setup: "Qt/PyQt 4 initialization failed"](#hp-setup:_.22Qt.2FPyQt_4_initialization_failed.22)
    *   [5.10 hp-setup: находит принтер автоматически, но сразу после этого сообщает "Unable to communicate with device" при печати тестовой страницы](#hp-setup:_.D0.BD.D0.B0.D1.85.D0.BE.D0.B4.D0.B8.D1.82_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D0.B0.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.2C_.D0.BD.D0.BE_.D1.81.D1.80.D0.B0.D0.B7.D1.83_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D1.8D.D1.82.D0.BE.D0.B3.D0.BE_.D1.81.D0.BE.D0.BE.D0.B1.D1.89.D0.B0.D0.B5.D1.82_.22Unable_to_communicate_with_device.22_.D0.BF.D1.80.D0.B8_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B8_.D1.82.D0.B5.D1.81.D1.82.D0.BE.D0.B2.D0.BE.D0.B9_.D1.81.D1.82.D1.80.D0.B0.D0.BD.D0.B8.D1.86.D1.8B)
    *   [5.11 hp-setup: "KeyError: 'family-class'"](#hp-setup:_.22KeyError:_.27family-class.27.22)
*   [6 Другие](#.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5)
    *   [6.1 Принтер "приостановлен - "Paused"" или "Остановлен" cо статусом "Рендеринг завершен"](#.D0.9F.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.22.D0.BF.D1.80.D0.B8.D0.BE.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD_-_.22Paused.22.22_.D0.B8.D0.BB.D0.B8_.22.D0.9E.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.22_c.D0.BE_.D1.81.D1.82.D0.B0.D1.82.D1.83.D1.81.D0.BE.D0.BC_.22.D0.A0.D0.B5.D0.BD.D0.B4.D0.B5.D1.80.D0.B8.D0.BD.D0.B3_.D0.B7.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.22)
        *   [6.1.1 Низкий уровень чернил](#.D0.9D.D0.B8.D0.B7.D0.BA.D0.B8.D0.B9_.D1.83.D1.80.D0.BE.D0.B2.D0.B5.D0.BD.D1.8C_.D1.87.D0.B5.D1.80.D0.BD.D0.B8.D0.BB)
    *   [6.2 Завершение печати из-за ошибок авторизации](#.D0.97.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B8_.D0.B8.D0.B7-.D0.B7.D0.B0_.D0.BE.D1.88.D0.B8.D0.B1.D0.BE.D0.BA_.D0.B0.D0.B2.D1.82.D0.BE.D1.80.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8)
    *   [6.3 Unknown supported format: application/postscript](#Unknown_supported_format:_application.2Fpostscript)
    *   [6.4 Ошибка задания для печати (Print-Job) client-error-document-format-not-supported](#.D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.D0.B7.D0.B0.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_.D0.B4.D0.BB.D1.8F_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B8_.28Print-Job.29_client-error-document-format-not-supported)
    *   [6.5 Не удается получить список драйверов принтера](#.D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.BF.D0.BE.D0.BB.D1.83.D1.87.D0.B8.D1.82.D1.8C_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.B4.D1.80.D0.B0.D0.B9.D0.B2.D0.B5.D1.80.D0.BE.D0.B2_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0)
    *   [6.6 lp: Error - Scheduler Not Responding](#lp:_Error_-_Scheduler_Not_Responding)
    *   [6.7 Сообщение об ошибке: "Using invalid Host"](#.D0.A1.D0.BE.D0.BE.D0.B1.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B5:_.22Using_invalid_Host.22)
    *   [6.8 Не удается отправить на печать из LibreOffice](#.D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.BE.D1.82.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D1.82.D1.8C_.D0.BD.D0.B0_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D1.8C_.D0.B8.D0.B7_LibreOffice)
    *   [6.9 Вывод принтера сдвинут](#.D0.92.D1.8B.D0.B2.D0.BE.D0.B4_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0_.D1.81.D0.B4.D0.B2.D0.B8.D0.BD.D1.83.D1.82)
    *   [6.10 Принтер не работает (приостановлен - "Paused") после ошибки](#.D0.9F.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D0.BD.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_.28.D0.BF.D1.80.D0.B8.D0.BE.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD_-_.22Paused.22.29_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B8)
    *   [6.11 Samsung: URF ERROR - Incomplete Session by time out](#Samsung:_URF_ERROR_-_Incomplete_Session_by_time_out)
    *   [6.12 Brother: Принтер печатает несколько копий](#Brother:_.D0.9F.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80_.D0.BF.D0.B5.D1.87.D0.B0.D1.82.D0.B0.D0.B5.D1.82_.D0.BD.D0.B5.D1.81.D0.BA.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BA.D0.BE.D0.BF.D0.B8.D0.B9)
    *   [6.13 Обычный пользователь не может изменять настройки принтера или удалять определенные задания](#.D0.9E.D0.B1.D1.8B.D1.87.D0.BD.D1.8B.D0.B9_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C_.D0.BD.D0.B5_.D0.BC.D0.BE.D0.B6.D0.B5.D1.82_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D1.8F.D1.82.D1.8C_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B8_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0_.D0.B8.D0.BB.D0.B8_.D1.83.D0.B4.D0.B0.D0.BB.D1.8F.D1.82.D1.8C_.D0.BE.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D0.B5_.D0.B7.D0.B0.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F)

## Введение

Наилучший способ борьбы с неисправностями - это выставить 'LogLevel' в файле `/etc/cups/cupsd.conf` на:

```
LogLevel debug

```

А потом посмотреть вывод из файла `/var/log/cups/error_log` например так:

```
# tail -n 100 -f /var/log/cups/error_log

```

Символы слева от вывода означают следующее:

*   D=Debug(отладка)
*   E=Error(ошибка)
*   I=Information(информация)
*   И так далее

Следующие файлы также могут быть полезны:

*   `/var/log/cups/page_log` - каждый раз при успешной печати, пишет новую запись
*   `/var/log/cups/access_log` - записывает всю активность на cupsd http1.1 сервере

Также, если вы хотите решить свои проблемы, важно понимать, как вообще работает CUPS. Вот краткая информация об этом:

1.  Когда вы жмёте 'печать' приложение отправляет .ps-файл (PostScript, язык-скрипт, который описывает, как выглядит страница) в систему CUPS (так происходит в большинстве программ).
2.  CUPS смотрит на PPD-файл (файл описания принтера) и находит, фильтры которые ему нужно использовать для преобразования .ps-файла в файл, который понимает ваш принтер (например, PJL,PCL). Обычно для этого ему требуется ghostscript.
3.  GhostScript принимает ввод и решает, какие фильтры ему использовать, потом применяет их и преобразовывает .ps-файл в формат, который понимает принтер.
4.  Затем файл передается бэкенду. Например, если у вас принтер подключен к usb порту, то используется usb бэкенд

Распечатайте документ и посмотрите `error_log`, чтобы получить более подробное и правильное представление об процессе печати.

## Проблемы, возникающие в результате обновлений

*Проблемы возникшие после обновления CUPS и сопутствующего ему набора программ*

### CUPS останавливается

Существует вероятность, что для правильной работы в обновленной версии понадобится новый файл конфигурации. Например, получение сообщения "404 - page not found" при попытке входа в панель управления CUPS через localhost:631.

Для того, чтобы воспользоваться новым конфигом, скопируйте `/etc/cups/cupsd.conf.default` в `/etc/cups/cupsd.conf` (при необходимости сделайте резервную копию старого конфига) и, чтобы новые настройки вступили в силу, перезапустите CUPS.

### Для всех заданий - "остановлено"

Если для всех отправленных на печать заданий установился статус "остановлено" ("stopped"), - удалите принтер и установите его заново. Для этого войдите в [веб-интерфейс CUPS](http://localhost:631), перейдите Принтеры > Удалить Принтер.

Для проверки настроек принтера перейдите во вкладку *Принтеры*, затем скопируйте отображаемую информацию. Далее нажмите на *Администрирование*. В выпадающем списке кликните *Изменить принтер*, перейдите к следующей странице(ам), и так далее.

### Для всех заданий - "Принтер не отвечает"

Для сетевых принтеров, поскольку CUPS подключается через URI, необходимо убедиться, что в DNS настроен доступ к принтерам по IP. Например, если принтер подключен следующим образом:

```
lpd://BRN_020554/BINARY_P1

```

то имя хоста 'BRN_020554' должно соответствовать IP принтера, управляемого сервером CUPS. Если используется [Avahi](/index.php/Avahi "Avahi"), убедитесь, что [разрешение имени хоста Avahi](/index.php/Avahi#Hostname_resolution "Avahi") работает.

Альтернативно, замените имя хоста, используемое в URI, IP-адресом принтера.

### Версия PPD не совместима с gutenprint

Запустите:

```
# /usr/bin/cups-genppdupdate

```

И перезагрузите CUPS (будет выведено соответствующее сообщение после установки gutenprint).

## Проблемы с сетью

### Не удается найти принтер

Даже если CUPS обнаруживает сетевые принтеры, вы все равно можете получить ошибку "Не удается найти принтер" ("Unable to locate printer") при попытке распечатать что-либо. Чтобы решить эту проблему, включите [.разрешение локального имени хоста](/index.php/Avahi#Hostname_resolution "Avahi") Avahi. Для получения дополнительной информации смотрите [CUPS (Русский)#Сеть](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#C.D0.B5.D1.82.D1.8C "CUPS (Русский)").

Эта проблема может возникать и при использовании файрвола (межсетевой экран, брандмауэр). Возможно, вам придется отключить его или установить корректные правила. Если вы используете system-config-printer для обнаружения сетевых принтеров, тогда он сделает все это автоматически.

### Старый сервер CUPS

Начиная с версии CUPS 1.6, клиент по умолчанию использует IPP 2.0\. Если сервер использует CUPS <= 1.5 / IPP <= 1.1, клиент не будет автоматически понижать версию протокола и, следовательно, не может связаться с сервером. Обходным путем является добавление опции `version=1.1`, описанной в [Таблице 2\. Опции URI IPP](https://www.cups.org/doc/network.html#TABLE2).

### Общий принтер работает локально, но удаленный компьютер не печатает

Это вызвано тем, что задание на печать отправляется через фильтр дважды, один раз на локальном компьютере и один раз на удаленном. Смотрите также предупреждение на главной странице [CUPS](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#.D0.A1.D0.B5.D1.82.D1.8C "CUPS (Русский)").

## USB-принтеры

### Конфликт с SANE

Если у вас также запущен [SANE](/index.php/SANE "SANE"), возможно, что он конфликтует с CUPS. Чтобы исправить это, создайте правило [Udev](/index.php/Udev_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Udev (Русский)"), обозначающее устройство как совпадающее с libsane:

 `/etc/udev/rules.d/99-printer.rules`  `ATTRS{idVendor}=="*vendor id(код производителя)*", ATTRS{idProduct}=="*product id(код продукта)*", MODE="0664", GROUP="lp", ENV{libsane_matched}="yes"` 

### Конфликт с usblp

Доступ к USB-принтерам можно получить двумя способами: модулем ядра usblp и libusb. Первый - это классический способ. Это просто: данные отправляются на принтер, записывая их в файл устройства в виде простого последовательного потока данных. Чтение одного и того же файла устройства позволяет использовать двунаправленный доступ, по крайней мере, для таких вещей, как считывание уровней чернил, статуса или информации о возможностях принтера (PJL). Он работает очень хорошо для простых принтеров, но для многофункциональных устройств (принтер/сканер) он не подходит, и производители, такие как HP, поставляют свои собственные бэкенды. Источник: [здесь](http://lists.linuxfoundation.org/pipermail/printing-architecture/2012/002412.html).

**Важно:** Начиная с [cups](https://www.archlinux.org/packages/?name=cups) версии 1.6.0, больше не нужно заносить в запрет загрузки модуль ядра `usblp`. Если вы узнаете, что это единственный способ исправить оставшуюся проблему, сообщите об этом в баг-трекер CUPS, а также можно связаться с Till Kamppeter (сопровождающий CUPS в Debian). Для получения дополнительной информации смотрите в [upstream bug](http://cups.org/str.php?L4128).

Если у вас возникли проблемы с работой USB-принтера, вы можете попробовать [запрет загрузки](/index.php/%D0%97%D0%B0%D0%BF%D1%80%D0%B5%D1%82_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8 "Запрет загрузки") для [модуля ядра](/index.php/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C_%D1%8F%D0%B4%D1%80%D0%B0 "Модуль ядра") `usblp`:

 `/etc/modprobe.d/blacklistusblp.conf` 
```
blacklist usblp

```

Пользователям кастомного ядра может потребоваться вручную загрузить [модуль ядра](/index.php/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C_%D1%8F%D0%B4%D1%80%D0%B0 "Модуль ядра") `usbcore`, прежде чем продолжить.

После установки модулей подключите принтер и проверьте, обнаружило ли его ядро, выполнив следующие действия:

```
# journalctl -e

```

или

```
# dmesg

```

Если вы используете `usblp`, вывод должен указывать на то, что принтер был обнаружен следующим образом:

```
Feb 19 20:17:11 kernel: printer.c: usblp0: USB Bidirectional
printer dev 2 if 0 alt 0 proto 2 vid 0x04E8 pid 0x300E
Feb 19 20:17:11 kernel: usb.c: usblp driver claimed interface cfef3920
Feb 19 20:17:11 kernel: printer.c: v0.13: USB Printer Device Class driver

```

Если вы запретили загрузку `usblp`, вы увидите что-то вроде:

```
usb 3-2: new full speed USB device using uhci_hcd and address 3
usb 3-2: configuration #1 chosen from 1 choice

```

### USB autosuspend

Ядро Linux автоматически приостанавливает USB-устройства, когда есть поддержка драйверов и устройства не используются. Это может сэкономить электроэнергию, но некоторые USB-принтеры считают, что они не подключены, когда ядро приостанавливает USB-порт, предотвращая печать. Это можно устранить, отключив autosuspend для конкретного устройства, для получения дополнительной информации смотрите [Power management#USB autosuspend](/index.php/Power_management#USB_autosuspend "Power management").

### Плохие разрешения

Проверьте разрешения USB-порта принтера. Получите номер шины (BUSID) и устройства (DEVID) от `lsusb`:

 ` lsusb `  ` Bus <BUSID> Device <DEVID>: ID <PRINTERID>:<VENDOR> Hewlett-Packard DeskJet D1360` 

Проверьте владельца, просмотрев devfs:

```
 # ls -l /dev/bus/usb/<BUSID>/<DEVID>

```

Демон cups запускается от пользователя "cups" и относится к группе "lp", поэтому либо этому пользователю, либо группе требуется доступ на чтение и запись в USB-устройство. Если вы считаете, что разрешения выглядят неправильно, вы можете временно изменить группу и разрешение:

```
# chgrp lp /dev/bus/usb/<BUSID>/<DEVID>
# chmod 664 /dev/bus/usb/<BUSID>/<DEVID>

```

Затем проверьте, может ли cups теперь видеть устройство USB правильно.

Чтобы сделать постоянное изменение разрешения, которое будет запускаться автоматически при каждом запуске компьютера, добавьте следующую строку.

 `/etc/udev/rules.d/10-local.rules`  `SUBSYSTEM=="usb", ATTRS{idVendor}=="<VENDOR>", ATTRS{idProduct}=="<PRINTERID>", GROUP:="lp", MODE:="0664"` 

После редактирования перезагрузите правила udev этой командой:

```
# udevadm control --reload-rules

```

Каждая система может отличаться, поэтому обратитесь к вики-странице [udev (Русский)#Список атрибутов устройства](/index.php/Udev_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#.D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.B0.D1.82.D1.80.D0.B8.D0.B1.D1.83.D1.82.D0.BE.D0.B2_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0 "Udev (Русский)").

## Проблемы с HP

Смотрите также [CUPS/Принтероспецифичные проблемы#HP](/index.php/CUPS/%D0%9F%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B#HP "CUPS/Принтероспецифичные проблемы").

### CUPS: "/usr/lib/cups/backend/hp failed"

Убедитесь, что dbus установлен и запущен. Если ошибка повторяется, попробуйте запустить avahi-daemon.

Попробуйте добавить принтер в качестве сетевого принтера, используя протокол http:// .

**Примечание:** Там, возможно, потребуется установить права доступа.

### CUPS: "Печать завершена", но принтер не печатает.

Это происходит на принтерах HP, когда вы выбираете (старый) драйвер hpijs (например, для Deskjet D1600 series). Вместо этого используйте драйвер hpcups.

Некоторые принтеры HP требуют, чтобы их прошивка загружалась с компьютера при каждом включении принтера. Вы можете столкнуться с этой проблемой, если есть проблема с udev (или аналогом), и правило загрузки прошивки никогда не запускается. В качестве обходного пути вы можете вручную загрузить прошивку на принтер. Убедитесь, что принтер подключен и включен, затем выполните

```
hp-firmware -n

```

### CUPS: '"foomatic-rip" not available/stopped with status 3'

Если, во время использования принтера HP, задания появляются в очереди, но все завершаются со статусом 'остановлен' ('stopped'), а в `/var/log/cups/error_log` возникает одно из следующих сообщений об ошибках:

```
Filter "foomatic-rip" for printer *printer_name* not available: No such file or director

```

или:

```
PID *pid* (/usr/lib/cups/filter/foomatic-rip) stopped with status 3!

```

убедитесь, что [hplip](https://www.archlinux.org/packages/?name=hplip) [установлен](/index.php/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD "Установлен").

### CUPS: "Filter failed"

Ошибка "filter failed" может быть вызвана некоторым количеством причин. Журнал ошибок CUPS (по умолчанию `/var/log/cups/error_log`) должен записывать, какой фильтр не удалось загрузить и почему.

#### Отсутствует ghostscript

Установите [ghostscript](https://www.archlinux.org/packages/?name=ghostscript) (`/usr/lib/cups/filter/gstoraster` нуждается в его запуске).

#### Отсутствует foomatic-db

Установите [foomatic-db](https://www.archlinux.org/packages/?name=foomatic-db) и [foomatic-db-ppds](https://www.archlinux.org/packages/?name=foomatic-db-ppds). Это помогает в некоторых случаях.

#### Avahi не включен

[Запустите](/index.php/%D0%97%D0%B0%D0%BF%D1%83%D1%81%D1%82%D0%B8%D1%82%D0%B5 "Запустите") и [включите](/index.php/%D0%92%D0%BA%D0%BB%D1%8E%D1%87%D0%B8%D1%82%D0%B5 "Включите") службу `avahi-daemon`.

#### Устаревший плагин

Эта ошибка может указывать на то, что плагин устарел (версия несовместима) и может произойти после обновления системы, возможно, появится сообщение `Plugin error` в журнале (логе). Если вы установили [hplip-plugin](https://aur.archlinux.org/packages/hplip-plugin/), вам нужно обновить пакет, иначе перезапустите `hp-setup -i`, чтобы установить последнюю версию плагина.

#### Устаревшая конфигурация принтера

Начиная с [hplip-plugin](https://aur.archlinux.org/packages/hplip-plugin/) версии 3.17.11 hpijs больше не доступен. Если у вас есть принтеры, использующие hpijs, они не будут печатать. Необходимо перенастроить их и выбрать вместо этого новый драйвер hpcups.

Вы можете проверить, если это ваш случай, посмотрев в error_log cups`а:

 ` $ grep hpijs /var/log/cups/error_log ` 
```
 ...
 D [09/Jan/2018:14:32:58 +0000] [Job 97] **sh: hpijs: command not found**
 ...
```

### CUPS: печатает только пустую страницу и страницу с сообщением об ошибке на HP LaserJet

Существует ошибка, которая приводит к сбою CUPS при печати изображений на HP LaserJet (в моем случае 3380). Ошибки были зафиксированы и исправлены в [Ubuntu](https://bugs.launchpad.net/ubuntu/+source/cups-filters/+bug/998087). Первая страница пуста, вторая страница содержит следующее сообщение об ошибке:

```
 ERROR:
 invalidaccess
 OFFENDING COMMAND:
 filter
 STACK:
 /SubFileDecode
 endstream
 ...

```

Чтобы устранить проблему, выполните следующую команду как суперпользователь (root):

```
# lpadmin -p *printer* -o pdftops-renderer-default=pdftops

```

### HPLIP 3.13: Плагин установлен, но HP Device Manager жалуется на его отсутствие

Возможно, проблема связана с изменением прав доступа файла, которое было внесено в `/var/lib/hp/hplip.state`. Чтобы исправить проблему, достаточно простых команд `chmod 644 /var/lib/hp/hplip.state` и `chmod 755 /var/lib/hp`. Для получения дополнительной информации, пожалуйста, прочитайте [эту ссылку](https://bugs.launchpad.net/hplip/+bug/1131596).

### hp-toolbox: "Unable to communicate with device"

```
# hp-toolbox
# error: Unable to communicate with device (code=12): hp:/usb/*printer id*

```

#### Разрешение проблемы

Может потребоваться добавить пользователя в [группы](/index.php/%D0%93%D1%80%D1%83%D0%BF%D0%BF%D1%8B "Группы") `lp` и `sys`.

#### Виртуальный CDROM у принтеров

Это также может быть вызвано принтерами, такими как P1102, которые предоставляют виртуальный привод CD-ROM для драйверов MS Windows. Появляется lp dev, а затем исчезает. В этом случае попробуйте пакеты **usb-modeswitch** и **usb-modeswitch-data**, что позволяет отключить "Smart Drive" (правила udev, включенные в указанные пакеты).

#### Сетевые принтеры

Это также может происходить с сетевыми принтерами, использующими динамические имена хостов, если [avahi-daemon](/index.php/Avahi "Avahi") не запущен. Другая причина заключается в том, что *hp-setup* не удалось найти принтер, потому что IP-адрес принтера изменился из-за DHCP. Если это так, подумайте о добавлении резервирования DHCP для принтера в конфигурации сервера DHCP.

### hp-setup просит указать PPD-файл для обнаруженного принтера

Кроме того, при выборе файла PPD в графическом режиме hp-setup поле не обновляется и сообщение об ошибке не отображается.

Или, если вы используете интерактивный (консольный) режим, можно столкнуться с чем-то похожим на это даже при введении правильного пути к файлу ppd:

```
 Please enter the full filesystem path to the PPD file to use (q=quit) :/usr/share/ppd/HP/hp-deskjet_2050_j510_series.ppd.gz
 Traceback (most recent call last):
   File "/usr/bin/hp-setup", line 536, in <module>
     desc = nickname_pat.search(nickname).group(1)
 TypeError: cannot use a string pattern on a bytes-like object

```

Решение заключается в установке и запуске [cups](https://www.archlinux.org/packages/?name=cups) перед запуском `hp-setup`.

### hp-setup: "Qt/PyQt 4 initialization failed"

[Установите](/index.php/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D0%B5 "Установите") пакет [python-pyqt4](https://aur.archlinux.org/packages/python-pyqt4/), который дополнительно требуется (optdepend) для [hplip](https://www.archlinux.org/packages/?name=hplip). Альтернативно вы можете запустить hp-setup с интерфейсом командной строки с помощью флага `-i`.

### hp-setup: находит принтер автоматически, но сразу после этого сообщает "Unable to communicate with device" при печати тестовой страницы

Это, по крайней мере, происходит с hplip 3.13.5-2 у принтера HP Officejet 6500A через локальное сетевое соединение. Чтобы решить проблему, укажите IP-адрес принтера HP для hp-setup, чтобы обнаружить принтер.

### hp-setup: "KeyError: 'family-class'"

Если при добавлении принтера в пользовательском интерфейсе он не работает, или вы получили `KeyError: 'family-class'` от `hp-setup`, возможно потребуется обновить вручную `/usr/share/hplip/data/models/models.dat`.

Проверьте определен ли раздел `family-class=Undefined` для вашего принтера. Если нет, добавьте это:

 `/usr/share/hplip/data/models/models.dat` 
```
[hp_laserjet_pro_mfp_m225dw]	
...
family-class=Undefined
```

## Другие

### Принтер "приостановлен - "Paused"" или "Остановлен" cо статусом "Рендеринг завершен"

#### Низкий уровень чернил

При низком уровне чернил некоторые принтеры зависают со статусом "Рендеринг завершен" ("Rendering completed"), и, если это сетевой принтер, принтер может даже стать недоступным для CUPS, несмотря на то, что он правильно подключен к сети. Замена картриджа (картриджей) с низким уровнем чернил в этом случае вернет принтер в статус "Готов" ("Ready") и, если он - сетевой принтер, то он станет снова доступным для CUPS.

**Примечание:** Если вы используете сторонние чернильные картриджи, то принтер может сообщать неточную информацию о уровне чернил. Если вы используете сторонние картриджи, и ваш принтер работал нормально, но теперь завис со статусом "Рендеринг завершен" ("Rendering completed"), замените чернильные картриджи, независимо от уровня отображаемых чернил, перед тем, как пробовать другие решения проблемы.

### Завершение печати из-за ошибок авторизации

Если удаленный принтер запрашивает аутентификацию, CUPS автоматически добавит директиву `AuthInfoRequired` для принтера в `/etc/cups/printers.conf`. Однако некоторые графические приложения (например, некоторые версии [LibreOffice](/index.php/LibreOffice_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "LibreOffice (Русский)") [[1]](https://bugs.documentfoundation.org/show_bug.cgi?id=53029)) не имеют возможности запрашивать учетные данные, поэтому печать завершилась с ошибкой. Чтобы исправить это, укажите требуемое имя пользователя и пароль в URI. Для получения дополнительной информации смотрите [[2]](https://bugs.launchpad.net/ubuntu/+source/cups/+bug/283811), [[3]](https://bbs.archlinux.org/viewtopic.php?id=61826).

### Unknown supported format: application/postscript

(***Не найдена поддержка формата: application/postscript***)

Закомментируйте строки:

```
application/octet-stream        application/vnd.cups-raw        0      -

```

в `/etc/cups/mime.convs` и:

```
application/octet-stream

```

в `/etc/cups/mime.types`.

### Ошибка задания для печати (Print-Job) client-error-document-format-not-supported

Попробуйте установить пакет foomatic и используйте драйвер foomatic.

### Не удается получить список драйверов принтера

(Также применимо к ошибке "-1 не поддерживается!")

Попробуйте удалить драйверы Foomatic или обратитесь к [CUPS/Принтероспецифичные проблемы#HPLIP](/index.php/CUPS/%D0%9F%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B#HPLIP "CUPS/Принтероспецифичные проблемы") для обходного пути.

### lp: Error - Scheduler Not Responding

Если вы получите эту ошибку, убедитесь, что [CUPS](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "CUPS (Русский)") запущен, переменная окружения `CUPS_SERVER` не установлена и `/etc/cups/client.conf` корректный.

### Сообщение об ошибке: "Using invalid Host"

Попробуйте добавить `ServerAlias *` в `/etc/cups/cupsd.conf`.

### Не удается отправить на печать из LibreOffice

Если вы можете распечатать тестовую страницу с веб-интерфейса [CUPS](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "CUPS (Русский)"), но не из [LibreOffice](/index.php/LibreOffice_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "LibreOffice (Русский)"), попробуйте [установить](/index.php/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C "Установить") пакет [a2ps](https://www.archlinux.org/packages/?name=a2ps).

### Вывод принтера сдвинут

По-видимому, это связано с неправильным размером страницы, установленным в [CUPS](/index.php/CUPS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "CUPS (Русский)").

### Принтер не работает (приостановлен - "Paused") после ошибки

Когда во время печати возникает ошибка, принтер в CUPS может перестать отвечать на запросы. `lpq` сообщает, что принтер `is not ready` (не готов), его можно активировать с помощью `cupsenable`. В веб-интерфейсе CUPS принтер отображается как *приостановлен - "Paused"*, его можно возобновить с помощью *Восстановить печать*.

Чтобы CUPS автоматически активировал принтер, измените [политику ошибок](https://www.cups.org/doc/man-cupsd.conf.html?TOPIC=Man+Pages#ErrorPolicy) с стандартной настройки `Останавливать принтер` (stop-printer) на `Повторить задание` (retry-this-job).

### Samsung: URF ERROR - Incomplete Session by time out

Эта ошибка обычно возникает при печати файлов по сети через IPP на принтерах Samsung и решается с помощью пакета [samsung-unified-driver](https://aur.archlinux.org/packages/samsung-unified-driver/).

**Примечание:** Соответствующий код ошибки 11-1112 соответствует внутренней проблеме с принтером, поэтому обращение к технической поддержке Samsung бесполезно.

### Brother: Принтер печатает несколько копий

Иногда принтер печатает несколько копий документа (например, MFC-9330CDW напечатал 10 копий). Решение заключается в [обновлении прошивки принтера](/index.php/CUPS/%D0%9F%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D1%84%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B#.D0.9E.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D1.88.D0.B8.D0.B2.D0.BA.D0.B8 "CUPS/Принтероспецифичные проблемы").

### Обычный пользователь не может изменять настройки принтера или удалять определенные задания

Если обычный пользователь должен иметь возможность изменять настройки принтеров или управлять очередью принтера, пользователь может быть добавлен в группу `sys`.