synaptics — это драйвер для тачпадов Synaptics, которые встраиваются в большинство ноутбуков. Эта статья поможет вам установить и настроить работу драйвера так, как вам необходимо.

## Contents

*   [1 Установка](#.D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0)
*   [2 Настройка](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0)
    *   [2.1 Настройка тачпада в файле конфигурации X-сервера](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D0.B2_.D1.84.D0.B0.D0.B9.D0.BB.D0.B5_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8_X-.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D0.B0)
    *   [2.2 Часто используемые опции](#.D0.A7.D0.B0.D1.81.D1.82.D0.BE_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D0.B5.D0.BC.D1.8B.D0.B5_.D0.BE.D0.BF.D1.86.D0.B8.D0.B8)
    *   [2.3 GNOME/Cinnamon](#GNOME.2FCinnamon)
    *   [2.4 MATE](#MATE)
    *   [2.5 Конфигурирование "на лету"](#.D0.9A.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.22.D0.BD.D0.B0_.D0.BB.D0.B5.D1.82.D1.83.22)
        *   [2.5.1 xinput](#xinput)
        *   [2.5.2 GPointingDeviceSettings](#GPointingDeviceSettings)
        *   [2.5.3 Настройка тачпада через правило HAL](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D1.87.D0.B5.D1.80.D0.B5.D0.B7_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.BE_HAL)
        *   [2.5.4 Настройка сенсорной панели через xinput](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.81.D0.B5.D0.BD.D1.81.D0.BE.D1.80.D0.BD.D0.BE.D0.B9_.D0.BF.D0.B0.D0.BD.D0.B5.D0.BB.D0.B8_.D1.87.D0.B5.D1.80.D0.B5.D0.B7_xinput)
*   [3 Детальная конфигурация](#.D0.94.D0.B5.D1.82.D0.B0.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F)
    *   [3.1 Тонкая настройка при помощи synclient](#.D0.A2.D0.BE.D0.BD.D0.BA.D0.B0.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.BF.D1.80.D0.B8_.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D0.B8_synclient)
    *   [3.2 Круговая прокрутка](#.D0.9A.D1.80.D1.83.D0.B3.D0.BE.D0.B2.D0.B0.D1.8F_.D0.BF.D1.80.D0.BE.D0.BA.D1.80.D1.83.D1.82.D0.BA.D0.B0)
    *   [3.3 Отключение тачпада при подключенной мыши](#.D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D0.BF.D1.80.D0.B8_.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.BD.D0.BE.D0.B9_.D0.BC.D1.8B.D1.88.D0.B8)
    *   [3.4 Эмуляция среднего клика мыши](#.D0.AD.D0.BC.D1.83.D0.BB.D1.8F.D1.86.D0.B8.D1.8F_.D1.81.D1.80.D0.B5.D0.B4.D0.BD.D0.B5.D0.B3.D0.BE_.D0.BA.D0.BB.D0.B8.D0.BA.D0.B0_.D0.BC.D1.8B.D1.88.D0.B8)
*   [4 Решение проблем](#.D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC)
    *   [4.1 Мой тачпад не /dev/input/mouse0](#.D0.9C.D0.BE.D0.B9_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4_.D0.BD.D0.B5_.2Fdev.2Finput.2Fmouse0)
    *   [4.2 Отключение кликов мыши при наборе с клавиатуры](#.D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BB.D0.B8.D0.BA.D0.BE.D0.B2_.D0.BC.D1.8B.D1.88.D0.B8_.D0.BF.D1.80.D0.B8_.D0.BD.D0.B0.D0.B1.D0.BE.D1.80.D0.B5_.D1.81_.D0.BA.D0.BB.D0.B0.D0.B2.D0.B8.D0.B0.D1.82.D1.83.D1.80.D1.8B)
    *   [4.3 Прокрутка включена, но не работает](#.D0.9F.D1.80.D0.BE.D0.BA.D1.80.D1.83.D1.82.D0.BA.D0.B0_.D0.B2.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B0.2C_.D0.BD.D0.BE_.D0.BD.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82)
    *   [4.4 Не работает прокрутка и тапы после логина](#.D0.9D.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_.D0.BF.D1.80.D0.BE.D0.BA.D1.80.D1.83.D1.82.D0.BA.D0.B0_.D0.B8_.D1.82.D0.B0.D0.BF.D1.8B_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.BB.D0.BE.D0.B3.D0.B8.D0.BD.D0.B0)
    *   [4.5 Firefox неправильно распознаёт горизонтальную прокрутку](#Firefox_.D0.BD.D0.B5.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D1.8C.D0.BD.D0.BE_.D1.80.D0.B0.D1.81.D0.BF.D0.BE.D0.B7.D0.BD.D0.B0.D1.91.D1.82_.D0.B3.D0.BE.D1.80.D0.B8.D0.B7.D0.BE.D0.BD.D1.82.D0.B0.D0.BB.D1.8C.D0.BD.D1.83.D1.8E_.D0.BF.D1.80.D0.BE.D0.BA.D1.80.D1.83.D1.82.D0.BA.D1.83)
    *   [4.6 Создал правило, но изменений в работе тачпада не произошло](#.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BB_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.BE.2C_.D0.BD.D0.BE_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B2_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B5_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D0.BD.D0.B5_.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.BE.D1.88.D0.BB.D0.BE)
    *   [4.7 Создал правило/конфиг но GNOME его игнорирует](#.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BB_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.BE.2F.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3_.D0.BD.D0.BE_GNOME_.D0.B5.D0.B3.D0.BE_.D0.B8.D0.B3.D0.BD.D0.BE.D1.80.D0.B8.D1.80.D1.83.D0.B5.D1.82)
    *   [4.8 Устройство определяется как "ImPS/2 Wheel Pointer" или как "PS/2 Generic Mouse"](#.D0.A3.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.BE_.D0.BE.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D1.8F.D0.B5.D1.82.D1.81.D1.8F_.D0.BA.D0.B0.D0.BA_.22ImPS.2F2_Wheel_Pointer.22_.D0.B8.D0.BB.D0.B8_.D0.BA.D0.B0.D0.BA_.22PS.2F2_Generic_Mouse.22)
    *   [4.9 Отключение "Авто-скроллинга" в 1.5.99.903](#.D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.22.D0.90.D0.B2.D1.82.D0.BE-.D1.81.D0.BA.D1.80.D0.BE.D0.BB.D0.BB.D0.B8.D0.BD.D0.B3.D0.B0.22_.D0.B2_1.5.99.903)
*   [5 Ссылки](#.D0.A1.D1.81.D1.8B.D0.BB.D0.BA.D0.B8)

## Установка

Вы можете установить модули synaptics из репозитория Extra при помощи [pacman](/index.php/Pacman_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Pacman (Русский)"):

```
# pacman -S xf86-input-synaptics

```

## Настройка

Основной способ конфигурации тачпада - через настройку файла сервера [Xorg](/index.php/Xorg_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Xorg (Русский)"). После установки `xf86-input-synaptics`, файл с настройками по умолчанию находится в `/usr/share/X11/xorg.conf.d/50-synaptics.conf`. Пользователь может скопировать этот файл в `/etc/X11/xorg.conf.d/` и отредактировать под своё специфичное устройство. Для получения списка всех доступных опций, необходимо обратиться к synaptics(4) man-руководства.

### Настройка тачпада в файле конфигурации X-сервера

Основным способом конфигурации тачпада является редактирование файла настроек [Xorg](/index.php/Xorg "Xorg"). После установки пакета _xf86-input-synaptics_, появляется исходный конфигурационный файл _/etc/X11/xorg.conf.d/10-synaptics.conf_ следующего содержания:

```
Section "InputClass"
       Identifier "touchpad catchall"
       Driver "synaptics"
       MatchIsTouchpad "on"
       MatchDevicePath "/dev/input/event*"
           Option "TapButton1" "1"
           Option "TapButton2" "2"
           Option "TapButton3" "3"
EndSection

```

Пользователи могут использовать все доступные возможности, которые предоставляет драйвер _synaptics_, редактируя этот файл. К счастью все опции имеют собственное имя-идентификатор и хорошо документированы. Для прочтения руководства введите:

```
man synaptics

```

### Часто используемые опции

Следующий листинг удовлетворит потребности большинства пользователей. Это просто часть конфигурационного файла в _/etc/X11/xorg.conf.d/10-synaptics.conf_, можно заметить, что при использовании данной конфигурации включается вертикальная, горизонтальная и круговая прокрутка:

 `/etc/X11/xorg.conf.d/50-synaptics.conf` 

```
Section "InputClass"
    Identifier "touchpad"
    Driver "synaptics"
    MatchIsTouchpad "on"
        Option "TapButton1" "1"
        Option "TapButton2" "2"
        Option "TapButton3" "3"
        Option "VertEdgeScroll" "on"
        Option "VertTwoFingerScroll" "on"
        Option "HorizEdgeScroll" "on"
        Option "HorizTwoFingerScroll" "on"
        Option "CircularScrolling" "on"
        Option "CircScrollTrigger" "2"
        Option "EmulateTwoFingerMinZ" "40"
        Option "EmulateTwoFingerMinW" "8"
        Option "CoastingSpeed" "0"
        Option "FingerLow" "35"
        Option "FingerHigh" "40"
        ...
EndSection

```

Синтаксис: **Система будет думать, что это именно эта кнопка**: (если ей соответствует код) код можно узнать с помощью команды _xev_.

*   **TapButton1**: (1) определяет клик одним пальцем как левую кнопку мыши
*   **TapButton2**: (2) определяет клик двумя пальцами как среднюю кнопку мыши
*   **TapButton3**: (3) определяет клик тремя пальцами как правую кнопку мыши
*   **RBCornerButton**: (целое число) определяет, какой кнопке мыши соответствует реакция на клик в правом нижнем углу тачпада (ислользуйте **Option "RBCornerButton" "3"** для имитации клика правой кнопки мыши при касании правого нижнего угла тачпада). См. _man synaptics_ для назначения кнопок на другие углы.
*   **VertEdgeScroll**: (on/0) включает вертикальную прокрутку при скольжении пальцем вдоль правого края тачпада.
*   **HorizEdgeScroll**: (on/0) включает горизонтальную прокрутку при скольжении пальцем вдоль нижнего края тачпада.

[См. пример](/index.php?title=Touchpad_Synaptics/10-synaptics.conf_example&action=edit&redlink=1 "Touchpad Synaptics/10-synaptics.conf example (page does not exist)") конфигурационного файла с комментариями. Разумеется, значения некоторых опций могут отличаться для разных компьютеров. Для более тонкой настройки загляните в [synclient](/index.php/Touchpad_Synaptics#fine-tuning_with_synclient "Touchpad Synaptics").

**Обратите внимание:** Если вы внезапно обнаружили, что ваши руки касаются тачпада при печати текста и это вызывает нежелательное нажатие средней клавиши, то измените значение опции `TapButton2` на 0.

, чтобы отключить ее.

Сохраните, закройте редактор и перезапустите X-сервер. Теперь у тачпада должны работать зоны прокрутки. Смотрите [Детальная конфигурация](#.D0.94.D0.B5.D1.82.D0.B0.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F) для более подробной информации.

Обратите внимание что ваш свежеисправленный конфигурационный файл Xorg приводит к автоматической загрузке модулей ядра **evdev** и **psmouse** от которых зависит synaptics, в том случае, если вы захотите добавить его для явной загрузки в массив MODULES файле /etc/rc.conf:

```
MODULES=( ... _**evdev psmouse**_ ... )

```

### GNOME/Cinnamon

Пользователи [GNOME](/index.php/GNOME_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "GNOME (Русский)") также могут редактировать настройки. По умолчанию в GNOME отключена симуляция клика левой кнопкой мыши, горизонтальная прокрутка, а также тачпад не отключается при нежелательном касании ладони во время печати.

Для изменения этих настроек в **Gnome 2**:

1.  Запустите <tt>gconf-editor</tt>
2.  Отредактируйте ключи в **/desktop/gnome/peripherals/touchpad/**.

Для изменения этих настроек в **Gnome 3**:

1.  Откройте _System Settings_.
2.  Выберите _Mouse and Touchpad_.
3.  Измените настройки на вкладке _Сенсорная панель_.

Демон настроек Gnome может заменять существующие настройки (например указанные в xorg.conf.d), которые в графической утилите настройки не представлены вовсе. Можно исправить подобное поведение Gnome:

1.  Запустите <tt>dconf-editor</tt>
2.  Отредактируйте **/org/gnome/settings-daemon/plugins/mouse/**
3.  Снимите маркеры со всех **активных** настроек

И никакой Gnome больше не помешает вам настроить работу тачпада.

### MATE

Как и с [GNOME](/index.php/GNOME "GNOME"), в MATE настройка выглядит схожим образом:

1.  Запустите `dconf-editor`
2.  Отредактируйте ключи в `org.mate.peripherals-touchpad` разделе.

Во избежании затирания настроек демоном Mate settings на предопределённые, выполните следующее:

1.  Запустите `dconf-editor`
2.  Отредактируйте `org.mate.SettingsDaemon.plugins.mouse`
3.  Снимите отметку с **active**.

### Конфигурирование "на лету"

Кроме традиционного, есть еще несколько способов конфигурирования. Драйвер Synaptics поддерживает изменение настроек "на лету". Это предполагает, что пользователи могут выбирать нужные им опции в приложении, которые вступят в силу немедленно, без перезапуска X. Возможны четыре варианта конфигурирования:

*   GPointingDeviceSettings (рекомендуемый)
*   synclient
*   xinput (рекомендуемый) [TODO]

#### xinput

Используйте `xinput list` чтобы определить название устройства.

Используйте `xinput list-props "SynPS/2 Synaptics TouchPad"` для того, чтобы увидеть доступные возможности.

Также можно прочесть руководства соответствующих программ.

#### GPointingDeviceSettings

GPointingDeviceSettings позволяет изменять настройки "на лету" через графический интерфейс для нескольких указующих устройств, присутствующих в вашей системе (например тачпад и мышь). Приложение представляет собой более функциональную альтернативу GSynaptics и рекомендуется к использованию в качестве основной программы графической конфигурации для указующих устройств (главным образом драйвера Synaptics). GPointingDeviceSettings доступен из пользовательского репозитория [AUR](https://aur.archlinux.org/packages.php?ID=25663).

GPointingDeviceSettings требует **xf86-input-synaptics** и **libsynaptics**. Эти пакеты доступны в [extra] и [community] репозиториях, Вы можете установить их используя pacman.

```
$ sudo pacman -S xf86-input-synaptics libsynaptics

```

#### Настройка тачпада через правило [HAL](/index.php/HAL_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "HAL (Русский)")

В связи с тем, что последние версии X-server меньше зависят от настроек в файле xorg,conf, можно заметить что не все настройки тачпада были применены так, как это было там записано. Проверить это можно, выполнив в терминале :

```
  $ synclient -l

```

Таким образом Вы получите список всех действующих на данный момент значений. Сверьте их с теми, что записаны в xorg.conf. Если есть несовпадения ( как правило — определение размера тачпада и как следствие — проблемы с прокруткой), то следует перенести настройки тачпада в правило HAL. Для этого необходимо закоментировать в файле конфигурации X-сервера строчку отоносящуюся к тачпаду :

```
Section "ServerLayout"
	...
	InputDevice    "USB Mouse" "CorePointer"
	**_# InputDevice    "Touchpad"  "SendCoreEvents"_**
EndSection

```

Создайте новое правило для HAL :

```
# gedit /etc/hal/fdi/information/11-x11-synaptics.fdi

```

и добавте туда следующее :

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<deviceinfo version="0.2">
  <device>
    <match key="info.product" contains="ETPS/2 Elantech Touchpad">
        <append key="info.capabilities" type="strlist">input.touchpad</append>
    </match> 
    <match key="info.capabilities" contains="input.touchpad">
        <merge key="input.x11_driver" type="string">synaptics</merge>
        <merge key="input.x11_options.SHMConfig" type="string">true</merge> 
        <merge key="input.x11_options.LeftEdge" type="string">934</merge>
        <merge key="input.x11_options.RightEdge" type="string">5750</merge>
        <merge key="input.x11_options.TopEdge" type="string">430</merge>
        <merge key="input.x11_options.BottomEdge" type="string">4700</merge>
        <merge key="input.x11_options.FingerHigh" type="string">45</merge>
        <merge key="input.x11_options.FingerLow" type="string">40</merge>
        <merge key="input.x11_options.FingerPress" type="string">255</merge>
        <merge key="input.x11_options.MaxTapTime" type="string">120</merge>
        <merge key="input.x11_options.MaxTapMove" type="string">221</merge>
        <merge key="input.x11_options.EmulateMidButtonTime" type="string">75</merge>
        <merge key="input.x11_options.EmulateTwoFingerMinZ" type="string">55</merge>
        <merge key="input.x11_options.EmulateTwoFingerMinW" type="string">10</merge>
        <merge key="input.x11_options.VertScrollDelta" type="string">100</merge>
        <merge key="input.x11_options.HorizScrollDelta" type="string">100</merge>
        <merge key="input.x11_options.MinSpeed" type="string">0.4</merge>
        <merge key="input.x11_options.MaxSpeed" type="string">0.5</merge>
        <merge key="input.x11_options.AccelFactor" type="string">0.00995223</merge>
        <merge key="input.x11_options.EdgeMotionMinSpeed" type="string">1</merge>
        <merge key="input.x11_options.EdgeMotionMaxSpeed" type="string">401</merge>
        <merge key="input.x11_options.UpDownScrolling" type="string">1</merge>
        <merge key="input.x11_options.LeftRightScrolling" type="string">1</merge>
        <merge key="input.x11_options.TapButton1" type="string">1</merge>
        <merge key="input.x11_options.TapButton2" type="string">2</merge>
        <merge key="input.x11_options.TapButton3" type="string">3</merge>
        <merge key="input.x11_options.ClickFinger1" type="string">1</merge>
        <merge key="input.x11_options.ClickFinger2" type="string">1</merge>
        <merge key="input.x11_options.ClickFinger3" type="string">1</merge>
        <merge key="input.x11_options.CircularScrolling" type="string">0</merge>
        <merge key="input.x11_options.CircScrollDelta" type="string">0.03</merge>
        <merge key="input.x11_options.CircScrollTrigger" type="string">0</merge>
    </match>
  </device>
</deviceinfo>

```

В секции

```
type="string">[значение]</merge>

```

Вы можете подставлять свои значения, добиваясь необходимой работы тачпада. По аналогии с имеющимся, Вы можете добавлять необходимые опции. Доступные опции смотрите в [детальной конфигурации](#.D0.94.D0.B5.D1.82.D0.B0.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F). После чего сохраните файл, закройте редактор и перезапустите hal, чтобы он перечитал правила

```
# /etc/rc.d/hal restart

```

и перезапустите Х-сервер, чтобы настройки вступили в силу.

**Обратите внимание**: в случае если изменений не произошло посмотрите в [решение проблем](#.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BB_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.BE.2C_.D0.BD.D0.BE_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B2_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B5_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D0.BD.D0.B5_.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.BE.D1.88.D0.BB.D0.BE)

#### Настройка сенсорной панели через xinput

Если Вы стали счастливым обладателем GNOME версии 2.28 и выше, то видимо первое, что может броситься в глаза, это практически полная неуправляемость устройства по приведенным выше рекомендациям. Все дело в том, что теперь более тонкая настройка производится через xinput ( но, все же, конфигурационный файл, по приведенной выше **Настройка тачпада через правило HAL** рекомендации, может понадобиться ). Все доступные опции Вы можете просмотреть, выполнив в терминале следующее:

```
 $ xinput list --short

```

В ответ на это можно будет наблюдать примерно следующий вывод:

```
⎡ Virtual core pointer                      id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer            id=4    [slave  pointer  (2)]
⎜   ↳ Macintosh mouse button emulation      id=6    [slave  pointer  (2)]
⎜ **↳ SynPS/2 Synaptics TouchPad            id=7    [slave  pointer  (2)]**
⎣ Virtual core keyboard                     id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard           id=5    [slave  keyboard (3)]
    ↳ AT Translated Set 2 keyboard          id=8    [slave  keyboard (3)]
    ↳ Power Button                          id=9    [slave  keyboard (3)]
    ↳ Video Bus                             id=10   [slave  keyboard (3)]

```

**SynPS/2 Synaptics TouchPad** это и есть Ваша сенсорная панель. Запомните значение, указанное после **id=** в этой строке. Далее, выполните в терминале команду

```
$ xinput list-props 7

```

Таким образом на экран будет выведен список доступных свойств этого устройства и их значения. Давайте для примера попробуем выключить и включить сенсорную панель ( пример взят не случайно ). Для этого выполните в терминале

```
$ xinput set-int-prop 7 'Device Enabled' 8 1

```

где **7**- id устройства, **Device Enabled**- свойство, которое мы изменяем и **1** - целое значение, где, в данном случае, **0** выключает устройство и **1** включает. За более детальной информацией обратитесь к справочной странице

```
$ man xinput

```

Если же Вам требуется всего лишь вернуть пропавший клик, то для Вас доступно более простое решение. Для этого необходимо зайти в меню **Система -> Параметры -> Мышь** , в открывшемся окне перейти на вкладку **"Манипулятор Тачпэд"** и включить пункт **"Включить клик на тачпэде"**. Либо просто выполнив команду в терминале

```
$ gconftool-2 --set --type boolean /desktop/gnome/peripherals/touchpad/tap_to_click true

```

## Детальная конфигурация

Драйвер <tt>synaptics</tt> предоставляет множество опций для настройки. Следующий список описывает опции секции _InputDevice_, которую мы объявили в конфигурационном файле Xorg ( или в параметре "**input.x11_options**" в правиле HAL ):

**Identifier** — имя этого устройства ввода, которое мы указали в секции _ServerLayout_ выше.

**Device** указывает на файл устройства synaptic. Смотрите [Решение проблем](#.D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC) чтобы найти ваше устройство, если у вас это не /dev/input/mouse0\.

**LeftEdge**, **RightEdge**, **TopEdge** и **BottomEdge** — целые числа, которые задают виртуальные размеры вашего тачпада в координатах x и y.

**FingerLow** и **FingerHigh** — целочисленные значения, определяющие 'силу нажатия', которую драйвер расценит как прикосновение (сила нажатия становится больше FingerHigh) или отпускание (сила нажатия падает ниже FingerLow).

**MaxTapTime** — целое число, определяющее максимальную задержку в миллисекундах для одиночного нажатия (tap), которое рассматривается как клик мыши.

**MaxTapMove** — целое число, определяющее максимальное перемещение пальца для засчитывания одиночного нажатия (tap).

**MinSpeed** и **MaxSpeed** являются минимальным и максимальным коэффициентами скорости. Дробные числа с плавающей точкой.

**AccelFactor** — коэффициент ускорения, также дробное число с плавающей точкой.

**SHMConfig** — булевское значение (on/off) для включения/выключения использования разделяемой памяти. Эта опция должна быть включена, если вы хотите наблюдать и конфигурировать ваше устройство synaptics такими клиентскими утилитами как synclient, который мы будем использовать в данной статье.

**EmulateTwoFingerMinW' , EmulateTwoFingerMinZ' , EmulateMidButtonTime** — опции для настройки эмуляции клика двумя пальцами.

Больше информации по опциям вы найдёте на man-страничке synaptics:

```
man 5 synaptics

```

### Тонкая настройка при помощи synclient

Монитор synclient может отображать силу нажатия и положение пальца на тачпаде в реальном времени, позволяя точно задавать опции synaptics под свои нужды. Для работы synclient требуется чтобы опция **SHMConfig** была установлена в **on** или **true**.

Вы можете запустить монитор synaptics следующей командой:

```
$ synclient -m 100

```

где **-m** активирует монитор, а следующее за опцией число задаёт интервал обновления в миллисекундах.

Этот монитор предоставляет информацию о текущем состоянии вашего тачпада. Например, если вы двигаете тачпадом указатель мыши, то значения x и y в мониторе synclient будут изменяться. Таким образом вы можете легко узнать виртуальные размеры вашего тачпада, которые задаються в опциях **LeftEdge**, **RightEdge**, **BottomEdge** и **TopEdge**.

Аббревиатуры расшифровываются следующим образом:

**time**

	время в секундах с начала логирования.

**x, y**

	координаты x/y пальца на тачпаде. Точка отсчёта — верхний левый угол.

**z**

	давление. Характеризует вашу силу нажатия на тачпад при работе с ним.

**f**

	количество пальцев, которые сейчас прикасаются к тачпаду.

**w**

	ширина пальца.

**l,r,u,d,m,multi**

	состояния левой(left), правой(right), (верхней)up, (нижней)down, (средней)middle и многофункциональной (multi) кнопок. Нажатое состояние отражается единицей, ненажатое — нулём.

**gl,gm,gr**

	для тачпадов с подключаемым устройством (guest device) эти параметры соответствуют его состоянию кнопок: левой(guest left), средней(guest middle) и правой (guest right). Кнопки могут быть нажаты(1) или не нажаты(0).

**gdx, gdy**

	координаты x/y подключаемого устройства (guest device).

Если какое-то значение постоянно равно нулю, это означает что ваше устройство не поддерживает его.

Если графа **f** отображает максимальное значение **1**, но есть необходимость в использовании двухпальцевого режима, в таком случае обратите внимание на опции **EmulateTwoFingerMinW**,**EmulateTwoFingerMinZ** и **EmulateMidButtonTime** ( см. [Детальная конфигурация](#.D0.94.D0.B5.D1.82.D0.B0.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F)) и добавьте соответствующие строки в файл [конфигурации](#.D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0) ( [в правило](#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.82.D0.B0.D1.87.D0.BF.D0.B0.D0.B4.D0.B0_.D1.87.D0.B5.D1.80.D0.B5.D0.B7_HAL) ).

Вооружившись этими знаниями вы сможете подобрать правильные значения для вашего тачпада.

### Круговая прокрутка

Круговая прокрутка — это удобство, предлагаемое вам synaptics, которое вы могли знать по iPod. Вместо (или, в придачу к) прокрутке по горизонтали или по вертикали, вы можете осуществлять прокрутку по кругу. Многие пользователи находят этот способ более быстрым и точным. Для включения круговой прокрутки, вам необходимо добавить следующие опции в секцию устройства ввода `/etc/X11/xorg.conf.d/50-synaptics.conf`:

 `/etc/X11/xorg.conf.d/50-synaptics.conf` 

```
Section "InputClass"
    ...
    Option      "CircularScrolling"          "on"
    Option      "CircScrollTrigger"          "0"
    ...
EndSection

```

Вы наверное догадались, что опция **CircularScrolling** включает или выключает круговую прокрутку. Опция **CircScrollTrigger** может принимать одно из следующих значений, определяющий с какой границы тачпада должна начинаться круговая прокрутка:

```
0    любая
1    верхняя
2    правый верхний угол
3    правая
4    правый нижний угол
5    нижняя
6    левый нижний угол
7    левая
8    левый верхний угол

```

Задание этой опции отличной от нуля может быть полезным если вы хотите использовать круговую прокрутку совместно с горизонтальной и/или вертикальной прокруткой. В таком случае тип прокрутки будет определяться границей тачпада с которой вы её начинаете.

Для быстрой прокрутки рисуйте маленькие круги в центре вашего тачпада. Для медленной и более точной прокрутки рисуйте большие.

### Отключение тачпада при подключенной мыши

При помощи [udev](/index.php/Udev_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Udev (Русский)") можно автоматически отключать тачпад при подключении внешней мыши!

Для достижения этого, просто добавьте следующее правило udev:

```
ACTION=="add", SUBSYSTEM=="input", ID_CLASS="mouse", RUN+="/usr/bin/synclient TouchpadOff=1"
ACTION=="remove", SUBSYSTEM=="input", ID_CLASS="mouse", RUN+="/usr/bin/synclient TouchpadOff=0"

```

Поместите это в **/etc/udev/rules.d/01-touchpad.rules**, убедитесь что опция **SHMConfig** включена и наслаждайтесь.

### Эмуляция среднего клика мыши

Добавьте это:

 `/etc/X11/xorg.conf.d/10-evdev.conf` 

```
Section "InputClass"
        Identifier "Emulate Middle Butten"
        MatchIsPointer "on"
        Option "Emulate3Buttons" "on"
EndSection

```

в /etc/X11/xorg.conf.d/10-evdev.conf (или любой другой конфигурационный файл Xorg, который вы захотите) и вы включите эмуляцию среднего клика: средний клик будет эмулироваться одновременным нажатием левой и правой кнопки мыши.

Если ваш тачпад поддерживает несколько одновременных нажатий, то вы можете эмулировать его, например, тройным нажатием, выполнив в терминале (работает в течение сессии):

```
synclient TapButton3=2

```

## Решение проблем

### Мой тачпад не /dev/input/mouse0

В этом случае вы можете посмотреть информацию по всем вашим устройствам ввода следующей командой:

```
cat /proc/bus/input/devices

```

Найдите устройство с именем "SynPS/2 Synaptics TouchPad". Вам нужно смотреть на параметр Handler, который подскажет вам какое устройство нужно указать в xorg.conf.

**Пример вывода:**

```
I: Bus=0011 Vendor=0002 Product=0007 Version=0000
N: Name="SynPS/2 Synaptics TouchPad"
P: Phys=isa0060/serio4/input0
S: Sysfs=/class/input/input1
H: Handlers=mouse0 event1 
B: EV=b
B: KEY=6420 0 7000f 0

```

Т.к. выши Handler'ы _mouse0_ и _event1_, вам нужно использовать _/dev/input/mouse0_.

### Отключение кликов мыши при наборе с клавиатуры

Это маленькая хитрость встроенная в драйвер synaptics, позволяет быть уверенным, что тачпад отключен во время набора с клавиатуры. Это очень легко настроить, и здесь я опишу как это сделать.

просто добавьте следующую строку в ваш .xinitrc до запуска оконного менеджера:

```
syndaemon -i 2 -d

```

Ключ **-i 2** устанавливает время простоя в 2 секунды. Это интервал, который будет проходить со времени последнего нажатия клавиши до включения тачпада обратно, а опция -d запускает программу в качастве демона ( в фоновом режиме ).

Также вы можете добавить ключ **-t** который говорит демону не отключать перемещение мыши, а отключать только клики и прокрутку:

```
syndaemon -t -i 2 -d

```

Как обычно более детальную информацию вы можете найти на man-страничке:

```
$ man syndaemon

```

### Прокрутка включена, но не работает

Если после включения прокрутки (горизонтальной или вертикальной) она так и не заработала, то попробуйте поиграть с опциями RightEdge и BottomEdge (если для прокруток Вы хотите использовать эти области) и для вертикальной и горизонтальной прокрутки соответственно, уменьшая их значения. Таким же образом можно отрегулировать и ширину области прокрутки.

### Не работает прокрутка и тапы после логина

Прокрутка, тапы работают в экране ввода логина и пароля, но перестают работать после загрузки Gnome. В Gnome в меню "Система-Параметры-Мышь-Манипулятор Тачпэд" находятся собственные настройки Gnome, которые перетирают настройки X.org.

### Firefox неправильно распознаёт горизонтальную прокрутку

Несмотря на то что эта проблема не касается драйверов synaptics, всё равно решение её вы, скорее всего, будете искать здесь.

Чтобы предотвратить firefox от прокрутки истории и заставить его прокручивать страницу, вам необходимо установить следующие настройки:

```
mousewheel.horizscroll.withnokey.action = 1
mousewheel.horizscroll.withnokey.sysnumlines = true

```

Вы можете отредактировать их открыв **about:config**. (Совет взят с [gentoo wiki](http://gentoo-wiki.com/HARDWARE_Synaptics_Touchpad#Horizontal_Scroll_Issues_with_Firefox).)

### Создал правило, но изменений в работе тачпада не произошло

Если в ходе редактирования созданного правила были допущены ошибки, то об этом можно узнать выполнив в терминале

```
$ cat /var/log/daemon.log | grep hald

```

Вот пример вывода:

```
Jun  9 08:18:15 sony-book hald[13626]: error in fdi file /etc/hal/fdi/information/11-x11-synaptics.fdi:71: mismatched tag

```

Посмотрите на ошибку, исправте ее в созданном правиле и перезапустите демон еще раз:

```
# /etc/rc.d/hal restart

```

### Создал правило/конфиг но GNOME его игнорирует

Чтобы GNOME пользовался системными настройками, но не теми скупыми пятью ключами в настройке сенсорной панели, необходимо просто выключить соответствующий плагин. Для этого необходимо открыть **gconf-editor**, и установить ключ **/apps/gnome_settings_daemon/plugins/mouse/active** в FALSE или выполнить в терминале:

```
$ gconftool-2 --set --type bool /apps/gnome_settings_daemon/plugins/mouse/active 0

```

### Устройство определяется как "ImPS/2 Wheel Pointer" или как "PS/2 Generic Mouse"

Если вы стали счастливым обладателем сенсорной панели жадного производителя Alps, который не в состоянии втиснуться в рамки стандартного протокола, но который изобретает новые "велосипеды", то Вам необходимо пересобрать модуль ядра, наложив на него патчи. Вы можете воспользоваться [этим](https://aur.archlinux.org/packages.php?ID=52538) пакетом либо собрать самостоятельно. Коротко опишу как это сделать: Для сборки Вам потребуются исходники Вашего ядра и патчи [отсюда](http://people.canonical.com/~sforshee/alps-touchpad/). Далее распаковываем архив с исходниками ядра, переходим в корень распакованных исходников и накладываем патчи командой:

```
 $ patch -p1 < patch_name.patch

```

Выполняем для каждого патча, в порядке, указанном цифрами в его имени. Переходим в каталог с исходниками драйвера

```
 $ cd drivers/input/mouse

```

И выполняем здесь

```
 $ make -C /lib/modules/`uname -r`/build M=`pwd` psmouse.ko

```

Пробуем вставить полученный модуль в ядро:

```
 $ sudo rmmod psmouse && sudo insmod ./psmouse.ko

```

И смотрим как определилась наша панель иксами:

```
 $ cat /var/log/Xorg.0.log | tail -50

```

Если Вы видите, что теперь устройство определилось как "Alps PS/2 (Dual | Glide)Point", то все в порядке и можно переходить к следующим действиям. Копируем полученный модуль к модулям текущего ядра

```
 $ sudo cp psmouse.ko /lib/modules/$(uname -r)/kernel/drivers/input/mouse/
 $ sudo depmod
 $ sudo mkinitcpio -g /boot/your_initrd.img

```

Если в результате не возникло ошибок, то можно переходить к тонкой настройке сенсорной панели, описанной в этой статье. Если же после сборки модуля не произошло никаких изменений, то, возможно, Вам необходимо вписать цифровую подпись Вашего устройства в файле alps.c, в распакованных исходниках ядра.

**Обратите внимание:** Учитывая, что сообщество обладает только частью спецификаций для поделий компании Alps, то не стоит пока рассчитывать на то, что Ваша сенсорная панель увидит больше одного пальца. Но в результате выше описанных действий, Вы должны получить вменяемо работающую сенсорную панель, отключаемую во время набора текста, имеющую круговую и горизонтальную прокрутки с регулируемыми зонами и чувствительностью.

### Отключение "Авто-скроллинга" в 1.5.99.903

Для отключения новой функции "Авто-скроллинг" добавленной в последнем релизе драйвера (она позволяет скроллить информацию как на мобильных устройствах, то есть после того как пользователь убрал палец от тачпада, информация все еще скроллится), добавьте в файл `/etc/X11/xorg.conf.d/10-synaptics.conf`:

 `/etc/X11/xorg.conf.d/10-synaptics.conf` 

```
...
Option "CoastingSpeed" "0"
...

```

## Ссылки

Synaptics TouchPad driver для XOrg/XFree86 : [[1]](http://web.telia.com/~u89404340/touchpad/index.html)

Gnome 2.28 Changes : [[2]](https://wiki.archlinux.org/index.php/Gnome_2.28_Changes)