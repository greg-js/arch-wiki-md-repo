Ссылки по теме

*   [Неофициальные зеркала](/index.php/%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B7%D0%B5%D1%80%D0%BA%D0%B0%D0%BB%D0%B0 "Неофициальные зеркала")
*   [pacman (Русский)](/index.php/Pacman_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Pacman (Русский)")

**Состояние перевода:** На этой странице представлен перевод статьи [Mirrors](/index.php/Mirrors "Mirrors"). Дата последней синхронизации: 26 декабря 2019\. Вы можете [помочь](/index.php/ArchWiki_Translation_Team_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "ArchWiki Translation Team (Русский)") синхронизировать перевод, если в английской версии произошли [изменения](https://wiki.archlinux.org/index.php?title=Mirrors&diff=0&oldid=591971).

На этой странице представлено руководство по выбору и настройке зеркал, а также список зеркал, доступных в настоящее время.

<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none">

## Contents

<label class="toctogglelabel" for="toctogglecheckbox"></label>

*   [1 Официальные зеркала](#Официальные_зеркала)
    *   [1.1 IPv6-зеркала](#IPv6-зеркала)
*   [2 Включение определённого зеркала](#Включение_определённого_зеркала)
    *   [2.1 Принудительное обновление списка пакетов pacman](#Принудительное_обновление_списка_пакетов_pacman)
*   [3 Сортировка зеркал](#Сортировка_зеркал)
    *   [3.1 Сортировка по скорости](#Сортировка_по_скорости)
        *   [3.1.1 Ранжирование существующего списка зеркал](#Ранжирование_существующего_списка_зеркал)
        *   [3.1.2 Получение и ранжирование свежего списка зеркал](#Получение_и_ранжирование_свежего_списка_зеркал)
    *   [3.2 Ранжирование на стороне сервера](#Ранжирование_на_стороне_сервера)
*   [4 Решение проблем](#Решение_проблем)
*   [5 Смотрите также](#Смотрите_также)

## Официальные зеркала

Список официальных зеркал предоставляется пакетом [pacman-mirrorlist](https://www.archlinux.org/packages/?name=pacman-mirrorlist). Наиболее свежий список зеркал доступен на странице [Pacman Mirrorlist Generator](https://www.archlinux.org/mirrorlist/).

Проверить статус зеркал Arch возможно на странице [Mirror Status](https://www.archlinux.org/mirrors/status/). Рекомендуется использовать только актуальные (синхронизированные) зеркала.

Если вы хотите добавить своё зеркало в официальный список, см. [DeveloperWiki:NewMirrors](/index.php/DeveloperWiki:NewMirrors "DeveloperWiki:NewMirrors"). Тем временем добавьте его в статью [Неофициальные зеркала](/index.php/%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B7%D0%B5%D1%80%D0%BA%D0%B0%D0%BB%D0%B0 "Неофициальные зеркала").

### IPv6-зеркала

[Pacman Mirrorlist Generator](https://www.archlinux.org/mirrorlist/?ip_version=6) можно также использовать для получения списка доступных IPv6-зеркал.

## Включение определённого зеркала

Чтобы включить зеркала, откройте файл `/etc/pacman.d/mirrorlist` и найдите ваш географический регион, после чего раскомментируйте необходимые зеркала.

Например:

```
# Any
# Server = http://mirrors.kernel.org/archlinux/$repo/os/$arch
**Server = https://mirrors.kernel.org/archlinux/$repo/os/$arch**

```

См. [#Сортировка зеркал](#Сортировка_зеркал) для получения информации об утилитах по выбору зеркал.

**Tip:**

*   Раскомментируйте 5 наиболее подходящих зеркал и поместите их наверху файла mirrorlist. Таким образом, их можно легко найти и поменять приоритет в случае возникновения проблем с первым зеркалом в списке. Это также упрощает слияние файлов mirrorlist при обновлении.
*   HTTP-зеркала быстрее FTP-зеркал из-за [постоянного HTTP-соединения](https://en.wikipedia.org/wiki/ru:%D0%9F%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D0%BE%D0%B5_HTTP-%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5 "wikipedia:ru:Постоянное HTTP-соединение") — в случае с FTP, необходимо устанавливать новое соединение с сервером при каждом запросе *pacman* на скачивание, что приводит к небольшим задержкам.

Также можно указать зеркала в `/etc/pacman.conf`. В случае с репозиторием *[core]*, по умолчанию это выглядит следующим образом:

```
[core]
Include = /etc/pacman.d/mirrorlist

```

Например, если необходимо по умолчанию использовать зеркало *HostEurope*, укажите его перед строкой `Include`:

```
[core]
**Server = http://ftp.hosteurope.de/mirror/ftp.archlinux.org/core/os/$arch**
Include = /etc/pacman.d/mirrorlist

```

Теперь pacman будет первым делом пытаться соединиться с этим зеркалом. Аналогично можно сделать и для остальных репозиториев: *[testing]*, *[extra]* и *[community]*.

**Примечание:** Если вы указываете зеркала напрямую в `pacman.conf`, следует использовать одно и то же зеркало для всех репозиториев. В противном случае можно столкнуться с тем, что будут установлены несовместимые версии пакетов, например, linux из *[core]* и более старые модули ядра из *[extra]*.

### Принудительное обновление списка пакетов pacman

Зеркала могут быть рассинхронизированы, из-за чего список пакетов на старом зеркале не будет соответствовать списку на новом зеркале, несмотря на дату, указанную в обоих списках.

После создания файла `/etc/pacman.d/mirrorlist` или его изменения выполните следующую команду:

```
# pacman -Syyu

```

{{Tip (Русский)|Указание двух аргументов `--refresh`/`-y` заставляет pacman обновить списки пакетов, даже если они уже считаются актуальными. Запуск `pacman -Syyu` — излишняя трата ресурсов в большинстве случае, но иногда позволяет исправить проблемы, возникающие при смене неисправного зеркала на исправное. См. также [Is -Syy safe?](https://bbs.archlinux.org/viewtopic.php?id=163124).

{{Warning (Русский)|В большинстве случаев, при принудительном обновлении базы данных pacman, необходимо также принудительно откатить "слишком новые" пакеты, чтобы их версии соответствовали версиям на новом зеркале. Это предотвращает проблемы, приводящие к частичному обновлению системы.

```
# pacman -Syyuu

```

Также данная процедура необязательна при использовании временных отметок (timestamps) для обеспечения обновления зеркал.

## Сортировка зеркал

При загрузке пакетов pacman использует зеркала в том порядке, в котором они перечислены в `/etc/pacman.d/mirrorlist`. Порядок серверов в списке задаёт их приоритет.

Сортировать зеркала только по скорости — не самый оптимальный вариант, так как самые быстрые сервера могут быть рассинхронизированы. Рекомендуется сначала отсортировать зеркала по [скорости](#Сортировка_по_скорости), после чего, в соответствии с их [статусом](https://www.archlinux.org/mirrors/status/), убрать из списка рассинхронизированые зеркала.

Также рекомендуется повторять данную процедуру перед каждым обновлением системы для поддержания списка зеркал в актуальном состоянии.

### Сортировка по скорости

#### Ранжирование существующего списка зеркал

Пакет [pacman-contrib](https://www.archlinux.org/packages/?name=pacman-contrib) предоставляет Bash-скрипт `/usr/bin/rankmirrors`, который можно использовать для ранжирования зеркал в соответствии со скоростями подключения и нахождения наиболее быстрых местных зеркал.

Создайте резервную копию текущего файл `/etc/pacman.d/mirrorlist`:

```
# cp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.backup

```

Необходимо выполнить следующие действия, чтобы подготовить файл `mirrorlist.backup` к к ранжированию с помощью *rankmirrors*:

*   Отредактируйте `mirrorlist.backup`, раскомментировав сервера, которые необходимо протестировать
*   Если сервера в файле сгруппированы по странам, возможно извлечь все сервера определённой страны следующим образом: `$ awk '/^## *Название страны*$/{f=1; next}f==0{next}/^$/{exit}{print substr($0, 1);}' /etc/pacman.d/mirrorlist.backup` 
*   Выполните следующую команду `sed`, чтобы раскомментировать все зеркала: `# sed -i 's/^#Server/Server/' /etc/pacman.d/mirrorlist.backup` 

И наконец, отсортируйте сервера. В данном случае, `-n 6` выводит только 6 наиболее быстрых зеркал:

```
# rankmirrors -n 6 /etc/pacman.d/mirrorlist.backup > /etc/pacman.d/mirrorlist

```

#### Получение и ранжирование свежего списка зеркал

Воспользуйтесь *Pacman Mirrorlist Generator*, чтобы получить список актуальных зеркал определённых стран и отсортировать его с помощью *rankmirrors*. Команда ниже скачивает актуальный список зеркал во Франции и Великобритании, использующих протокол *https*, после чего удаляет комментарии, ранжирует сервера и выводит 5 наиболее быстрых из них.

```
$ curl -s "[https://www.archlinux.org/mirrorlist/?country=FR&country=GB&protocol=https&use_mirror_status=on](https://www.archlinux.org/mirrorlist/?country=FR&country=GB&protocol=https&use_mirror_status=on)" | sed -e 's/^#Server/Server/' -e '/^#/d' | rankmirrors -n 5 -

```

**Совет:** Данные действия можно также выполнить интерактивно на странице `[https://www.archlinux.org/mirrorlist](https://www.archlinux.org/mirrorlist)` с помощью любого текстового браузера, например, [elinks(1)](https://jlk.fjfi.cvut.cz/arch/manpages/man/elinks.1).

### Ранжирование на стороне сервера

Официальный [Pacman Mirrorlist Generator](https://www.archlinux.org/mirrorlist/) предоставляет возможность легко получить ранжированный список зеркал. Весь процесс сортировки происходит на одном сервере с учётом различных факторов, что значительно снижает нагрузку на зеркала и клиентов в сравнении с ранжированием с каждого отдельного клиента.

Другая популярная альтернатива:

**[Reflector](/index.php/Reflector_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Reflector (Русский)")** — получает последний список зеркал со страницы [MirrorStatus](https://www.archlinux.org/mirrors/status/), фильтрует их, сортирует по скорости и перезаписывает `/etc/pacman.d/mirrorlist`

	[https://xyne.archlinux.ca/projects/reflector/](https://xyne.archlinux.ca/projects/reflector/) || [reflector](https://www.archlinux.org/packages/?name=reflector)

## Решение проблем

Если вы столкнулись со следующей ошибкой:

```
error: config file /etc/pacman.d/mirrorlist could not be read: No such file or directory

```

Загрузите список зеркал напрямую с сайта:

```
# curl -o /etc/pacman.d/mirrorlist https://www.archlinux.org/mirrorlist/all/

```

Раскомментируйте предпочитаемые зеркала, как описано выше, после чего выполните следующую команду:

```
# pacman -Syu pacman-mirrorlist

```

## Смотрите также

*   [mirrorlist.py](https://github.com/archlinux/archweb/blob/master/mirrors/views/mirrorlist.py) — исходный код генератора списка зеркал Archweb