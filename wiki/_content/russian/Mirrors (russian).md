Ссылки по теме

*   [Неофициальные зеркала](/index.php/%D0%9D%D0%B5%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D0%B7%D0%B5%D1%80%D0%BA%D0%B0%D0%BB%D0%B0 "Неофициальные зеркала")
*   [pacman (Русский)](/index.php/Pacman_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Pacman (Русский)")

На этой странице представлено руководство по выбору и настройке зеркал, а также список зеркал, доступных в настоящее время.

<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none">

## Contents

<label class="toctogglelabel" for="toctogglecheckbox"></label>

*   [1 Включение зеркал](#Включение_зеркал)
    *   [1.1 Обновление базы данных pacman после изменения зеркал](#Обновление_базы_данных_pacman_после_изменения_зеркал)
*   [2 Статус зеркала](#Статус_зеркала)
*   [3 Приоритет зеркал](#Приоритет_зеркал)
    *   [3.1 Список по скорости](#Список_по_скорости)
    *   [3.2 Список одновременно по скорости и статусу](#Список_одновременно_по_скорости_и_статусу)
    *   [3.3 Скрипт для получения списка зеркал из Pacman Mirrorlist Generator](#Скрипт_для_получения_списка_зеркал_из_Pacman_Mirrorlist_Generator)
    *   [3.4 Используя Reflector](#Используя_Reflector)
    *   [3.5 Выбор местного зеркала](#Выбор_местного_зеркала)
    *   [3.6 Список зеркал только для конкретной страны](#Список_зеркал_только_для_конкретной_страны)
*   [4 Официальные зеркала](#Официальные_зеркала)
    *   [4.1 Зеркала IPv6](#Зеркала_IPv6)
*   [5 Смотрите также](#Смотрите_также)

## Включение зеркал

Чтобы включить зеркала, откройте файл `/etc/pacman.d/mirrorlist` и найдите подходящие зеркала, основываясь на вашем географическом местоположении. Раскомментируйте наиболее близкие к вам зеркала.

**Примечание:** На ftp.archlinux.org установлено ограничение пропускной способности в 50 КБайт/с [[1]](https://www.archlinux.org/news/throttling-ftparchlinuxorg-rsyncarchlinuxorg/).

Пример:

```
# Any
# Server = ftp://mirrors.kernel.org/archlinux/$repo/os/$arch
**Server = http://mirrors.kernel.org/archlinux/$repo/os/$arch**

```

Разделы [#Статус зеркала](#Статус_зеркала) и [#Список по скорости](#Список_по_скорости) также помогут вам выбрать зеркало.

**Совет:** Раскомментируйте 5 наиболее подходящих вам зеркал и поместите их наверху файла mirrorlist. Таким образом, будет легко потом устанавливать приоритет, меняя их местами, если у первого зеркала в списке начнутся какие-нибудь проблемы. Это также упрощает слияние файлов mirrorlist при обновлениях списка зеркал.

Также вы можете указать зеркала в `/etc/pacman.conf`. Для репозитория *core* стандартная установка выглядит следующим образом:

```
[core]
Include = /etc/pacman.d/mirrorlist

```

Например, вы хотите использовать зеркало "HostEurope" для *core*. Тогда добавьте его перед `Include`:

```
[core]
**Server = ftp://ftp.hosteurope.de/mirror/ftp.archlinux.org/core/os/$arch**
Include = /etc/pacman.d/mirrorlist

```

Теперь pacman будет первым делом пытаться соединиться с этим зеркалом. Аналогично следует сделать и для других репозиториев: *testing*, *extra*, и *community*.

**Примечание:** Если вы указываете зеркала напрямую в `pacman.conf`, вам следует использовать одно и то же зеркало для всех репозиториев. В противном случае вы можете столкнуться с тем, что будут поставлены несовместимые версии пакетов из разных зеркал (так как зеркала синхронизируются не мгновенно).

### Обновление базы данных pacman после изменения зеркал

После внесения изменений в `/etc/pacman.d/mirrorlist` (неважно, вручную или с *rankmirrors*) выполните синхронизацию базы данных пакетов pacman:

```
# pacman -Syyu

```

**Совет:** Указание сразу двух опций `--refresh` или `-y` заставляет pacman обновлять списки пакетов, даже если pacman уже считает их обновленными. Запуск `pacman -Syyu` *при любой смене зеркала* является хорошей практикой и позволяет избежать возможных проблем.

## Статус зеркала

Проверить текущий статус любого зеркала вы можете на странице [https://www.archlinux.org/mirrors/status/](https://www.archlinux.org/mirrors/status/).

Вы можете использовать [Pacman Mirrorlist Generator](https://www.archlinux.org/mirrorlist/) для того, чтобы сгенерировать список подходящих зеркал. Для автоматизации этого процесса существует [#Скрипт для получения списка зеркал из Pacman Mirrorlist Generator](#Скрипт_для_получения_списка_зеркал_из_Pacman_Mirrorlist_Generator). Кроме того, вы можете установить [Reflector](/index.php/Reflector_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Reflector (Русский)") — утилиту, которая генерирует список зеркал на основе данных со страницы [Mirror Status](https://www.archlinux.org/mirrors/status/).

## Приоритет зеркал

При загрузке пакетов pacman использует зеркала в том порядке, в котором они перечислены в `/etc/pacman.d/mirrorlist`. Если вы не используете [Reflector](/index.php/Reflector_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Reflector (Русский)"), который может упорядочить зеркала и по степени обновления, и по скорости отдачи, вам поможет небольшая инструкция в этом разделе по ручной сортировке зеркал.

**Примечание:** Это не относится к [powerpill-light](/index.php/Improve_pacman_performance#Using_powerpill-light "Improve pacman performance"), который соединяется с несколькими серверами сразу для ускорения скорости загрузки. При этом скорость каждого соединения становится не так важна, и в powerpill-light можно настроить ограничение скорости на каждое соединение.

### Список по скорости

Сначала установите пакет [pacman-contrib](https://www.archlinux.org/packages/?name=pacman-contrib).

Самое быстрое зеркало можно определить при помощи скрипта `/usr/bin/rankmirrors`.

Сохраните текущий файл `/etc/pacman.d/mirrorlist`:

```
# cp /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.backup

```

Отредактируйте `/etc/pacman.d/mirrorlist.backup`, раскомментировав зеркала для проверки скриптом `rankmirrors`.

Если вы хотите попробовать все зеркала, используйте *sed* для раскомментирования всех зеркал:

```
# sed -i 's/^#Server/Server/' /etc/pacman.d/mirrorlist.backup

```

Теперь запустите скрипт. Опция `-n 6` ограничивает вывод шестью наиболее быстрыми зеркалами:

```
# rankmirrors -n 6 /etc/pacman.d/mirrorlist.backup > /etc/pacman.d/mirrorlist

```

Список всех доступных опций вы можете просмотреть, набрав `rankmirrors -h`.

### Список одновременно по скорости и статусу

Не самая лучшая идея просто использовать наиболее быстрые зеркала, так как они могут при этом обновляться с большим опозданием и содержать старые пакеты. Предпочтительнее сначала создать [#Список по скорости](#Список_по_скорости), а затем отсортировать этот список, проверяя [#Статус зеркала](#Статус_зеркала).

Просто просмотрите статус каждого из зеркал, как это написано в разделе [#Статус зеркала](#Статус_зеркала), и вручную расположите их в порядке от наиболее к наименее обновленному.

Сохраните полученный список в `/etc/pacman.d/mirrorlist`.

### Скрипт для получения списка зеркал из Pacman Mirrorlist Generator

[Pacman Mirrorlist Generator](https://www.archlinux.org/mirrorlist/) располагает зеркала на основе географического расположения, доступности и уровне. Вы можете использовать удобный скрипт агрузив его напрямую командой `curl -O [https://raw.githubusercontent.com/Gen2ly/armrr/master/armrr](https://raw.githubusercontent.com/Gen2ly/armrr/master/armrr)`), который позволяет на основе данных этого ресурса сгенерировать новый файл `mirrorlist`, создав резервную копию старого. Запустите скрипт без аргументов и введите код страны. Вы можете просмотреть список опций командной строки, набрав `armrr -h`.

### Используя Reflector

Вы можете использовать [Reflector](/index.php/Reflector_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9) "Reflector (Русский)") для того, чтобы получить свежий список зеркал со страницы [Mirror Status](https://www.archlinux.org/mirrors/status/), отсеять из них устаревшие, отсортировать по скорости и сгенерировать новый файл `/etc/pacman.d/mirrorlist`.

### Выбор местного зеркала

Простым способом настроить зеркала является просто найти местное зеркало в mirrorlist и поместить его на самый верх. Таким образом, pacman будет предпочитать именно это зеркало.

Как вариант, вы можете добавить это зеркало перед строкой, где выполняется запуск файла mirrorlist, то есть, где сказано "add your preferred servers here". Безопаснее использовать один и тот же сервер для каждого из репозиториев.

### Список зеркал только для конкретной страны

Может быть также полезно получать список зеркал только для какой-то конкретной страны вместо того, чтобы выполнять замер скорости загрузки для каждого.

```
Cnt="Russia";
awk -v GG=$Cnt '{if(match($0,GG) != "0")AA="1";if(AA == "1"){if( length($0) != "0"  )print $3 ;else AA="0"} }' \
/etc/pacman.d/mirrorlist.pacnew | grep ':' 
```

## Официальные зеркала

Список официальных зеркал доступен с пакетом [pacman-mirrorlist](https://www.archlinux.org/packages/?name=pacman-mirrorlist). Наиболее свежий список зеркал доступен на странице [Pacman Mirror List Generator](https://www.archlinux.org/mirrorlist/).

Если случилось так, что у вас нет настроенных зеркал и `pacman-mirrorlist` не установлен, загрузите его напрямую:

```
# wget -O /etc/pacman.d/mirrorlist https://www.archlinux.org/mirrorlist/all/

```

Не забудьте раскомментировать подходящее зеркало, как было указано выше, и выполнить синхронизацию списка пакетов:

```
# pacman -Syyu pacman-mirrorlist

```

Если вы имеете собственное зеркало и хотите, чтобы оно было добавлено в список официальных, присылайте feature request и добавьте свое зеркало в список [#Неофициальные зеркала](#Неофициальные_зеркала) в конце страницы.

Если вы получаете ошибку о том, что переменная `$arch` не определена, добавьте следующую строку в ваш `/etc/pacman.conf`:

```
Architecture = *x86_64*

```

**Примечание:** Здесь же вы можете использовать значения `auto` и `i686`.

### Зеркала IPv6

Используйте [Pacman Mirror List Generator](https://www.archlinux.org/mirrorlist/?country=all&protocol=http&ip_version=6) для запроса списка доступных зеркал IPv6.

## Смотрите также

*   [MirUp](http://wiki.gotux.net/code/bash/mirup) — pacman mirrorlist downloader/checker